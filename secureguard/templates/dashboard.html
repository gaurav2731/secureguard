<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>SecureGuard Dashboard</title>
  <meta http-equiv="refresh" content="2">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>🔐 SecureGuard AI Firewall</h1>

  <div class="card">
    <h2>Controls</h2>
    <form method="post" action="/block" style="display:inline-block;margin-right:8px;">
      <input type="text" name="ip" placeholder="IP to block" />
      <input type="number" name="minutes" placeholder="minutes (opt)" style="width:120px" />
      <button class="btn btn-red" type="submit">Block IP</button>
    </form>

    <form method="post" action="/unblock" style="display:inline-block;margin-right:8px;">
      <input type="text" name="ip" placeholder="IP to unblock" />
      <button class="btn btn-green" type="submit">Unblock IP</button>
    </form>

    <a href="/shutdown"><button class="btn btn-red">🚨 Emergency Shutdown</button></a>
    <a href="/simulate_attack"><button class="btn">⚔️ Simulate Attack</button></a>
    <a href="/api/resource" style="margin-left:8px;"><button class="btn">GET /api/resource</button></a>
  </div>

  <div class="card">
    <h2>Blocked IPs</h2>
    <table>
      <tr><th>IP</th><th>Reason</th><th>Until (UTC)</th></tr>
      {% for ip, reason, until in blocked %}
      <tr>
        <td>{{ ip }}</td>
        <td>{{ reason }}</td>
        <td>{{ until if until else 'permanent' }}</td>
      </tr>
      {% else %}
      <tr><td colspan="3">No blocked IPs</td></tr>
      {% endfor %}
    </table>
  </div>

  <div class="card">
    <h2>Recent Events</h2>
    <table>
      <tr><th>Time</th><th>IP</th><th>Path</th><th>Type</th><th>Detail</th></tr>
      {% for ts, ip, path, etype, detail in events %}
      <tr>
        <td>{{ ts }}</td>
        <td>{{ ip }}</td>
        <td>{{ path }}</td>
        <td>{{ etype }}</td>
        <td>{{ detail }}</td>
      </tr>
      {% else %}
      <tr><td colspan="5">No events logged</td></tr>
      {% endfor %}
    </table>
  </div>
</body>
</html>
